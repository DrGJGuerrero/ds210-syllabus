<html>
  <body>

<div class="wrapper">
  <div id="text"></div>
  <div class="buttons">
    <button id="play">Play</button>
    <button id="pause" disabled>Pause</button>
    <button id="stop" disabled>Stop</button>
  </div>
</div>
  <style>
*, *::before, *::after {
  box-sizing: border-box;
}

body {

}

.wrapper {
  width: 800px;
  max-width: calc(100vw - 40px);

}

#text {
  display: block;
  line-height: 1.75;
  font-size: 20;
  font-family: arial;
}

mark {
  color: #000;
}

.buttons {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  justify-content: center;
  gap: 10px;
  margin-top: 30px;
  padding-top: 30px;
  border-top: 1px solid #fff3;
}

button {
  padding: 5px;
  border: 1px solid #fff;
  border-radius: 999px;
  color: #fff;
  background-color: #0009;
  font-size: inherit;
  font-family: inherit;
  cursor: pointer;
  appearance: none;
}

button:disabled {
  opacity: 0.25;
  cursor: not-allowed;
} 
    </style>
  <script>
    const text = "Schedule.  **Class Location:** Dinneen Hall, G36. **Term Dates:** Wednesday, August 28 – Tuesday, December 17, 2024 (17 weeks). **Class Times:** Monday, Wednesday, Thursday at 11:00am–11:50am (42 class sessions)| Class | Date | Topics |  1 |  Wed, August 28      | WELCOME!! ||  2 |  Thurs, August 29    | In-Class Assessment ||  - |  Mon, September 2    | **No Class - Labor Day** ||  3 |  Wed, September 4    | Data Representation ||  4 |  Thurs, September 5  | In-Class Assessment ||  5 |  Mon, September 9    | Data Analysis ||  6 |  Wed, September 11   | Interdisciplinary Research ||  7 |  Thurs, September 12 | In-Class Assessment ||  8 |  Mon, September 16   | Database Queries ||  9 |  Wed, September 18   | Interdisciplinary Research || 10 |  Thurs, September 19 | In-Class Assessment || 11 |  Mon, September 23   | Decision Modeling || -  |  Wed, September 25   | **No Class - Michaelmas Convocation** || 12 |  Thurs, September 26 | In-Class Assessment || 13 |  Mon, September 30   | R Analytics || 14 |  Wed, October 2      | Interdisciplinary Research || 15 |  Thurs, October 3    | Midterm Exam || 16 |  Mon, October 7      | R Analytics || 17 |  Wed, October 9      | Interdisciplinary Research || 18 |  Thurs, October 10   | In-Class Assessment || 19 |  Mon, October 14     | Data Python || 20 |  Wed, October 16     | Interdisciplinary Research || 21 |  Thurs, October 17   | In-Class Assessment || 22 |  Mon, October 21     | Data Python || 23 |  Wed, October 23     | Interdisciplinary Research || 24 |  Thurs, October 24   | In-Class Assessment || 25 |  Mon, October 28     | Visual Insights || 26 |  Wed, October 30     | Interdisciplinary Research || 27 |  Thurs, October 31   | In-Class Assessment || 28 |  Mon, November 4     | Visualization Tools || 29 |  Wed, November 6     | Interdisciplinary Research || 30 |  Thurs, November 7   | In-Class Assessment || 31 |  Mon, November 11    | Data Storytelling || 32 |  Wed, November 13    | Interdisciplinary Research || 33 |  Thurs, November 14  | In-Class Assessment || 34 |  Mon, November 18    | Machine Learning || 35 |  Wed, November 20    | Interdisciplinary Research || 36 |  Thurs, November 21  | In-Class Assessment || 37 |  Mon, November 25    | Final Exam Overview || -  |  Wed, November 27    | **No Class - Thanksgiving Break** || -  |  Thurs, November 28  | **No Class - Thanksgiving Break** || 38 |  Mon, December 2     | Term Group Project || 39 |  Wed, December 4     | Term Group Project || 40 |  Thurs, December 5   | Term Group Project || 41 |  Mon, December 9     | CELEBRATION!! Term Group Project Presentation || 42 |  TBD | Final Exam - Mock Job Interview |"

// grab the UI elements to work with
const textEl = document.getElementById('text');
const playEl = document.getElementById('play');
const pauseEl = document.getElementById('pause');
const stopEl = document.getElementById('stop');

// add UI event handlers
playEl.addEventListener('click', play);
pauseEl.addEventListener('click', pause);
stopEl.addEventListener('click', stop);

// set text
textEl.innerHTML = text;

function play() {
  if (window.speechSynthesis.speaking) {
    // there's an unfinished utterance
    window.speechSynthesis.resume();
  } else {
    // start new utterance
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.addEventListener('start', handleStart);
    utterance.addEventListener('pause', handlePause);
    utterance.addEventListener('resume', handleResume);
    utterance.addEventListener('end', handleEnd);
    utterance.addEventListener('boundary', handleBoundary);
    window.speechSynthesis.speak(utterance);
  }
}

function pause() {
  window.speechSynthesis.pause();
}

function stop() {
  window.speechSynthesis.cancel();
  
  // Safari doesn't fire the 'end' event when cancelling, so call handler manually
  handleEnd();
}

function handleStart() {
  playEl.disabled = true;
  pauseEl.disabled = false;
  stopEl.disabled = false;
}

function handlePause() {
  playEl.disabled = false;
  pauseEl.disabled = true;
  stopEl.disabled = false;
}

function handleResume() {
  playEl.disabled = true;
  pauseEl.disabled = false;
  stopEl.disabled = false;
}

function handleEnd() {
  playEl.disabled = false;
  pauseEl.disabled = true;
  stopEl.disabled = true;
  
  // reset text to remove mark
  textEl.innerHTML = text;
}

function handleBoundary(event) {
  if (event.name === 'sentence') {
    // we only care about word boundaries
    return;
  }

  const wordStart = event.charIndex;

  let wordLength = event.charLength;
  if (wordLength === undefined) {
    // Safari doesn't provide charLength, so fall back to a regex to find the current word and its length (probably misses some edge cases, but good enough for this demo)
    const match = text.substring(wordStart).match(/^[a-z\d']*/i);
    wordLength = match[0].length;
  }
  
  // wrap word in <mark> tag
  const wordEnd = wordStart + wordLength;
  const word = text.substring(wordStart, wordEnd);
  const markedText = text.substring(0, wordStart) + '<mark>' + word + '</mark>' + text.substring(wordEnd);
  textEl.innerHTML = markedText;
}
  </script>
</body>
</html>


